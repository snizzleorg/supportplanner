<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SupportPlanner API Tests</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; padding: 16px; }
      h1 { font-size: 20px; margin: 0 0 12px; }
      .row { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; margin-bottom: 12px; }
      .panel { border: 1px solid #e5e7eb; border-radius: 8px; padding: 12px; margin: 8px 0; }
      .ok { color: #065f46; }
      .err { color: #b91c1c; }
      .mutating { background: #fff7ed; }
      code { background: #f3f4f6; padding: 2px 4px; border-radius: 4px; }
      table { border-collapse: collapse; width: 100%; }
      th, td { border: 1px solid #e5e7eb; padding: 6px 8px; text-align: left; font-size: 13px; }
      th { background: #f9fafb; }
      #log { white-space: pre-wrap; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; font-size: 12px; }
      .controls input[type="text"] { width: 520px; }
    </style>
  </head>
  <body>
    <h1>SupportPlanner API Tests</h1>

    <div class="panel">
      <div class="row"><strong>Non-mutating tests</strong></div>
      <div class="row">
        <button id="runNonMutating">Run fetchCalendars + refreshCaldav</button>
        <span id="nmStatus"></span>
      </div>
    </div>

    <div class="panel mutating">
      <div class="row"><strong>Mutating tests (optional)</strong></div>
      <div class="row controls">
        <label>Target Calendar URL</label>
        <input type="text" id="calendarUrl" placeholder="https://<host>/remote.php/dav/calendars/..." />
      </div>
      <div class="row">
        <button id="runMutating">Run create/update/delete roundtrip</button>
        <span id="mStatus"></span>
      </div>
      <div>Note: Only run these against a test calendar. These tests will create, update, and delete a temporary event.</div>
    </div>

    <div class="panel">
      <div class="row"><strong>Results</strong></div>
      <div id="summary"></div>
      <table id="resultsTable" style="display:none;">
        <thead>
          <tr>
            <th>Test</th>
            <th>Status</th>
            <th>Time (ms)</th>
            <th>Details</th>
          </tr>
        </thead>
        <tbody id="resultsBody"></tbody>
      </table>
    </div>

    <div class="panel">
      <div class="row"><strong>Log</strong></div>
      <div id="log"></div>
    </div>

    <script type="module" src="./api-tests.js"></script>
  </body>
</html>
